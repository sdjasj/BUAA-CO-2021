# 计算机组成原理实验报告参考模板
##一、CPU设计方案综述
###（一）总体设计概述
本CPU为Verilog实现的流水线MIPS - CPU，支持的指令集包含{addu、subu、……}。为了实现这些功能，CPU主要包含了IM、GRF、……，这些模块按照….的顶层设计逐级展开。
###（二）关键模块定义
1. GRF

| 信号名 | 方向 | 描述 |
| ---- | ---- | ---- |
|CLK|I|CPU时钟|
|Reset|I|异步复位信号|
|WE|I|写使能|
|A1[4:0]|I|rs输入|
|A2[4:0]|I|rt输入|
|A3[4:0]|I|rd输入|
|WD[31:0]|I|寄存器文件写入数据|
|RD1[31:0]|O|读寄存器文件时寄存器rs的输出|
|RD2[31:0]|O|读寄存器文件时寄存器rt的输出|
2. NPC

| 信号名 | 方向 | 描述 |
| --- | --- | --- |
|PC[31:0]|I|当前PC值|
|IMM26[25:0]|I|j型指令的26位立即数|
|IMM16[15:0]|I|b型指令的16位立即数|
|imm32[31:0]|I|jr型指令的寄存器数据|
|NPCOP[2:0]|I|npc控制指令|
|Zero|I|rs等于rt为1,判断b是否跳转|
|NPC[31:0]|O|下一个PC的值|
|PC+4[31:0]|O|当前PC+4|

功能定义

|OP值|功能|
|-|-|
|000|pc+4|
|001|beq|
|010|jal|
|011|jr|

3. ALU
   
| 信号名 | 方向 | 描述 |
| --- | --- | --- |
|A[31:0]|I|第一个操作数|
|B[31:0]|I|第二个操作数|
|ALUOP[3:0]|I|ALU功能控制|
|Zero|O|A与B是否相等，是为1|
|ALUOUT[31:0]|O|ALU计算结果|

功能定义

|OP值|功能|
|-|-|
|0000|A+B|
|0001|A-B|
|0010|A\|B|
|0011|A&B|
|0100|B<<16|

4.
###（三）重要机制实现方法

|复用器及选择|功能|
|-|-|
|RFA3MUX|\|
|000|rd|
|001|rt|
|010|$31|
|RFWDMUX|\|
|000|ALUOUT|
|001|DMOUT|
|010|PC+4|
|ALUBMUX|\|
|000|rt|
|001|imm16|
|EXTOP|\|
|0|sign|
|1|unsign 16|
|01|unsign 5|
|ALUAMUX|\|
|00|rs|
|01|rt|

#####指令的控制信号取值矩阵

|指令|NPCOP|RFWE|ALUOP|EXTOP|DMWE|RFA3MUX|RFWDMUX|ALUBMUX|ALUAMUX|
|-|-|-|-|-|-|-|-|-|-|
|ADDU|PC+4|1|ADD(0000)|X|0|000|000|000|00|
|SUBU|PC+4|1|SUB(0001)|X|0|000|000|000|00|
|ORI|PC+4|1|ori(0010)|1|0|001|000|001|00|
|LW|PC+4|1|ADD|0|0|001|001|001|00|
|SW|PC+4|0|ADD|0|1|XXX|XXX|001|00|
|BEQ|BEQ(001)|0|SUB|X|0|XXX|XXX|000|00|
|LUI|PC+4|1|LUI|1|0|001|000|001|00|
|SLL|PC+4|1|ADD|01|0|000|000|001|01|
|J|010|0|XXXX|XX|0|XXX|XXX|XXX|XX|
|JAL|010|1|XXXX|XX|0|010|010|XXX|XX|

1. 跳转
NPC模块和ALU模块协同工作支持指令x的跳转机制。
NPC模块内置了判定单元和计算单元来独立支持指令y的跳转机制。
2. 流水线延迟槽
……
3. 转发
……
4. 进入中断处理程序
……
##二、测试方案
###（一）典型测试样例
1. ALU功能测试
……
2. DM功能测试
……
3. 暂停测试
……
###（二）自动测试工具
1. 测试样例生成器
2. 自动执行脚本
3. 正确性判定脚本
##三、思考题
###（一）
题目描述 + 解答。